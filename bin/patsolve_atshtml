#! /bin/bash

DIR=$(dirname $0)
ATSHTML_SMT2=$DIR/../SMT2/atshtml.smt2

patsolve_smt2 -i | \
    sed 's/^(declare-fun ifint_bool_int_int .*$//' | \
    sed '/^(declare-fun lor16 .*$/ {
        r '$ATSHTML_SMT2'
        d
    }' | z3 -in | ( \
        grep -B 1 "^\(sat\|error\)" && echo "An error occurred during type checking!" && exit 1 || \
        echo "Type checking finished successfully!" && exit 0 \
    )
